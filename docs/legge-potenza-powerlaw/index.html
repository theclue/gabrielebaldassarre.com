<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.20.2 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="it" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Approfondimento matematico: la power law | Gabriele Baldassarre</title>
<meta name="description" content="La legge di potenza, o power law è uno dei costrutti matematici che ricoprono massima importanza in Social Network Analysis. In questo articolo ci doteremo di tutti gli strumenti teorici e metodologici per applicarla allo studio delle reti">


  <meta name="author" content="Gabriele Baldassarre">
  
  <meta property="article:author" content="Gabriele Baldassarre">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="it_IT">
<meta property="og:site_name" content="Gabriele Baldassarre">
<meta property="og:title" content="Approfondimento matematico: la power law">
<meta property="og:url" content="https://gabrielebaldassarre.com/legge-potenza-powerlaw/">


  <meta property="og:description" content="La legge di potenza, o power law è uno dei costrutti matematici che ricoprono massima importanza in Social Network Analysis. In questo articolo ci doteremo di tutti gli strumenti teorici e metodologici per applicarla allo studio delle reti">



  <meta property="og:image" content="https://gabrielebaldassarre.com/assets/images/powerlaw-overlay.jpg">



  <meta name="twitter:site" content="@bashebiscotti">
  <meta name="twitter:title" content="Approfondimento matematico: la power law">
  <meta name="twitter:description" content="La legge di potenza, o power law è uno dei costrutti matematici che ricoprono massima importanza in Social Network Analysis. In questo articolo ci doteremo di tutti gli strumenti teorici e metodologici per applicarla allo studio delle reti">
  <meta name="twitter:url" content="https://gabrielebaldassarre.com/legge-potenza-powerlaw/">

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://gabrielebaldassarre.com/assets/images/powerlaw-overlay.jpg">
  

  



  <meta property="article:published_time" content="2018-08-12T00:00:00-05:00">





  

  
    <meta property="fb:app_id" content="460740091056431">
  


<link rel="canonical" href="https://gabrielebaldassarre.com/legge-potenza-powerlaw/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": "Gabriele Baldassarre",
      "url": "https://gabrielebaldassarre.com/",
      "sameAs": ["https://twitter.com/bashebiscotti","https://www.linkedin.com/in/gabrielebaldassarre"]
    
  }
</script>






<!-- end _includes/seo.html -->


<link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Gabriele Baldassarre Feed">

<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML"></script>
  
    <script src="/assets/htmlwidgets-1.2/htmlwidgets.js"></script>
  
    <script src="/assets/vis-4.20.1/vis.min.js"></script>
  
    <script src="/assets/visNetwork-binding-2.0.4/visNetwork.js"></script>
  


    <link type="application/atom+xml" rel="alternate" href="https://gabrielebaldassarre.com/feed.xml" title="Gabriele Baldassarre" />

<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#2b5797">
<meta name="theme-color" content="#ededee">
<link href="/assets/vis-4.20.1/vis.css" rel="stylesheet" />

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Gabriele Baldassarre
          
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/sna">Social Network Analysis</a>
            </li><li class="masthead__menu-item">
              <a href="/meccanica-quantistica">Meccanica Quantistica</a>
            </li><li class="masthead__menu-item">
              <a href="/chi-sono">Chi Sono</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Mostra/Nascondi il Menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero--overlay"
  style=" background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('/assets/images/powerlaw-overlay.jpg');"
>
  
    <div class="wrapper">
      <h1 id="page-title" class="page__title" itemprop="headline">
        
          Approfondimento matematico: la power law

        
      </h1>
      
        <p class="page__lead">La legge di potenza, o <em>power law</em> è uno dei costrutti matematici che ricoprono massima importanza in Social Network Analysis. In questo articolo ci doteremo di tutti gli strumenti teorici e metodologici per applicarla allo studio delle reti
</p>
      
      

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          16 minuti di lettura
        
      </span>
    
  </p>


      
      
    </div>
  
  
</div>





<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/gabriele-baldassarre.png" alt="Gabriele Baldassarre" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Gabriele Baldassarre</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>Metti un <em>maker</em> a parlare di Fisica, Social Network Analysis, Informatica e Quantum Computing e questo è il risultato.</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Segui</button>
    <ul class="author__urls social-icons">
      
        <li itemprop="homeLocation" itemscope itemtype="https://schema.org/Place">
          <i class="fas fa-fw fa-map-marker-alt" aria-hidden="true"></i> <span itemprop="name">Milano, Italia</span>
        </li>
      

      
        
          
            <li><a href="https://github.com/theclue" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/gabrielebaldassarre" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="https://twitter.com/bashebiscotti" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://goodreads.com/theclue" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-goodreads" aria-hidden="true"></i><span class="label">Goodreads</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <li>
  <a href="https://goodreads.com/theclue"><i class="fab fa-fw fa-goodreads" aria-hidden="true"></i> Goodreads</a>
</li>
<li>
  <a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a>
</li>

    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Approfondimento matematico: la power law">
    <meta itemprop="description" content="La legge di potenza, o power law è uno dei costrutti matematici che ricoprono massima importanza in Social Network Analysis. In questo articolo ci doteremo di tutti gli strumenti teorici e metodologici per applicarla allo studio delle reti">
    <meta itemprop="datePublished" content="2018-08-12T00:00:00-05:00">
    

    <div class="page__inner-wrap">
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> Indice</h4></header>
              <ul class="toc__menu">
  <li><a href="#distribuzioni-normali-emeno-normali">Distribuzioni normali e…meno normali</a></li>
  <li><a href="#individuare-una-distribuzione-power-law">Individuare una distribuzione power law</a></li>
  <li><a href="#determinare-i-parametri-della-power-law">Determinare i parametri della power law</a></li>
  <li><a href="#esempi-noti-in-letteratura">Esempi noti in letteratura</a></li>
  <li><a href="#un-esempio-tutto-nostro-i-comuni-italiani">Un esempio tutto nostro: i comuni italiani</a></li>
  <li><a href="#per-approfondire">Per approfondire</a></li>
</ul>

            </nav>
          </aside>
        
        <p>Le legge di potenza altri non è che una funzione matematica con un andamento esponenziale caratterizzato da un parametro che può essere sia negativo che positivo e che nella sua forma più generale si esprime come</p>

\[f(x) = ax^k\]

<p>e di per sé non ha niente di speciale.</p>

<p>Diventa, però, interessante quando descrive una <em>distribuzione di probabilità</em>, ovvero la probabilità del verificarsi degli eventi misurati sull’ascissa. In questo frangente, si può osservare che tantissimi fenomeni fisici, dalla dimensione delle città a quella dei crateri da impatto, dalla magnitudine dei terremoti all’attenuazione acustiva, seguono qusto andamento.</p>

<p>Ma prima di addentrarci nello studio della legge di potenza, facciamo alcuni esempi chiarificatori di come si presentano, spesso, le grandezze in natura.</p>

<h2 id="distribuzioni-normali-emeno-normali">Distribuzioni normali e…meno normali</h2>

<p>Il modo più “naturale” in cui ci aspettiamo di misurare una grandezza è una distribuzione <em>centrale</em>, dove la maggior parte delle osservazioni si concentrano attorno a un valore tipico, il <em>valore medio</em>, e decadono molto velocemente in modo simmetrico ai due estremi. Molte distribuzioni, sia presenti in natura che costruite dall’uomo, hanno queste caratteristiche, che possono essere descritte, con un livello più o meno accettabile di approssimazione, con tutta una famiglia di modelli statistici, come la <a href="https://it.wikipedia.org/wiki/Distribuzione_normale">distribuzione gaussiana</a>, la <a href="https://it.wikipedia.org/wiki/Distribuzione_binomiale">distribuzione binomiale</a> e la <a href="https://it.wikipedia.org/wiki/Distribuzione_di_Poisson">quella di Poisson</a> che, dati una serie di parametri, è in grado di <em>spiegare</em> e <em>descrivere</em> la popolazione.</p>

<p>Non è detto, però, che le osservazioni si distribuiscano in modo simmetrico attorno ad un valore tipico. Alcune grandezze, infatti, si esprimono in popolazioni in cui si ha la maggioranza delle osservazioni su valori <em>bassi</em> delle ascisse, ma presentano anche diverse osservazioni molto a destra, in una lunga <em>coda</em> , con osservazioni che possono raggiungere valori della ascissa molto grandi, anche di diversi ordini di granzezza più grandi della media. Quello più sotto ne è un tipico esempio.</p>

<p><img src="/assets/figures/mobydick-1.svg" alt="Questi grafici mostrano le varie parole contenute nel Moby Dick di Herman Melville. In ascissa sono rappresentate le frequenze con cui una parola occorre nel testo. In ordinata, invece, il numero di parole che occorrono con una specifica frequenza. Sebbene la maggior parte delle parole abbiamo un numero di occorrenze molto basso, ce ne sono alcune che incorrono molto più frequentemente nel testo, causando la lunga coda a destra che, in un ripido decadimento, caratterizza la distribuzione, Il plot di destra mostra gli stessi dati ma su una scala logaritmica su entrambi gli assi, in modo da evidenziare meglio l'andamento esponenziale di tale decadimento. Il linguista George Kingsley Zipf ha potuto verificare, negli anni Trenta del Novecento, che la maggior parte della produzione letteraria occidentale segue questa distribuzione." /></p>

<p>Il grafico in scala <em>log-log</em>, mostra chiaramente un andamento assimilabile a quello di una retta per buona parte del suo dominio. Non lo è, apparentemente, nella parte più a destra, dove, però, vige più che altro un elevato errore di campionamento (come dicevamo, sono pochissime le parole ad avere un numero di occorrenze così elevato).</p>

<p>Passiamo ora dalle frequenze alle probabilità e quindi al differenziale. Se definiamo come \( p(x)dx \) la frazione di parole con un numero di occorrenze compreso tra \( x \) e \( x + dx \) e ci troviamo in un andamento più o meno rettilineo come quello appena evidenziato, allora la funzione, su scala logaritmica, può essere descritta come</p>

\[\ln p(x) = -\alpha \ln x + c\]

<p>con \( \alpha \) e \( c \) costanti. Elevando su \( e \) otteniamo la cosiddetta <strong>legge di potenza</strong> (o power law).</p>

<p>\(p(x) = Cx^{-\alpha} \tag{*}\)
con \( C = e^c \).</p>

<p>Una volta definito \( \alpha \), che è il parametro caratterizzante e che in genere (e soprattutto in ambito SNA) è compreso tra 2 e 3, e comunque non è mai minore di 1,  abbiamo tutto ciò che ci serve per descrivere la distribuzione. Il coefficiente \( C \), infatti, non è per nulla interessante ai fini pratici, dato che è semplicemente il termine che garantisce che la somma dell’area sottesa dalla curva sia 1, come obbligatorio che sia trovandoci di fronte a una funzione di probabilità.</p>

<p>In natura sono migliaia le grandezze che seguono la legge di potenza nel loro andamento probabilistico e spaziano dall’astronomia, alla linguistica (come abbiamo visto) fino, naturalmente, alle scienze sociali. Tuttavia, molto raramente una grandezza segue una power law sull’<em>interezza</em> delle misure che assume. Più spesso, essa segue questo andamento <em>a tratti</em>, mentre in altre regioni il suo andamento segue leggi diverse.</p>

<p>D’altra parte, per ciò che concerne in nostri scopi, poter affermare che una rete sociale segua, per alcuni suoi attributi (come, ad esempio, il grado) la legge di potenza, ci consente di poter desumere moltissimo sulla sua natura. Non è quindi una affermazione da fare alla leggera!</p>

<p>Per questo motivo, ora che sappiamo quali sono le sue caratteristiche, resta da capire come studiarla.</p>

<h2 id="individuare-una-distribuzione-power-law">Individuare una distribuzione <em>power law</em></h2>
<p>Innanzitutto una premessa, che facciamo riprendendo l’esempio di prima: dire che <strong>la r-esima parola più ricorrente in Moby Dick viene usata n volte</strong> è esattamente la stessa cosa di dire che <strong>esistono r parole che occorrono con una frequenza pari almenoa n</strong> (per capirci, <em>r</em> sta per <em>rank</em>).</p>

<p>Intanto, questo ci consente di pensare alla legge di potenza come a una funzione di <strong>distribuzione cumulativa di probabilità</strong>, e questo è utile a prescindere.</p>

<p>Ma, tornando all’interpretazione; il modo più semplice per individuare una power law è, in prima istanza, con un istogramma. Lo abbiamo involontariamente già visto con l’esempio precedente, in cui abbiamo rappresentato la popolazione in questa forma,  usando punti invece che barre per non affollare il grafico e riportando sulle ascisse gli intervalli \( k, k+n \) di occorrenze nel testo e sulle ordinate il conteggio delle parole contenute in tali intervalli. In particolare, l’andamento (quasi) lineare del grafico su assi logaritmici ci ha fatto pensare a una power law.</p>

<p>L’istogramma è stato costruito affinché l’ampiezza delle “barre” (o, più propriamente, <em>bin</em> o meglio ancora <em>intervalli</em>) fosse costante; il grafico che ne è risultato è decisamente ben definito nella parte sinistra, dove si concentrano la maggior parte delle osservazioni, ma molto confuso sulla <em>coda</em> di destra, dove ogni intervallo dell’istogramma ha pochi elementi e perciò le piccole fluttuazioni nel numero di componenti nel gruppo causa un grande scostamento sul grafico su scala logaritmica. Il problema è serio: andando a costruire su quel campione un modello di regressione per stimare il modulo di \( \alpha \), il rumore statistico sulla coda interverrà negativamente su di esso, introducendo una forte sottostima nel coefficiente.</p>

<p>Un modo più accurato consiste allora nel <em>variare la dimensione degli intervalli dell’isogramma con uno schema costante e normalizzare i risultati</em>, in modo da ottenere un conteggio <em>per unità di grandezza di x</em>. Questa operazione si chiama <em>non-linear binning</em>.</p>

<p>La logica più comune di binning è quella su base logaritmica, creando una sequenza di intervalli di dimensione esponenzialmente crescente ad es. \( 2^0=1, 2^1=2, 2^2=4, 2^3=8,…\)
In questo modo, gli intervalli a destra otterranno un maggior numero di campioni, abbattendo il rumore statistico. Applichiamo questa trasformazione ai dati di Moby Dick:</p>

<p><img src="/assets/figures/mobydick.log-1.svg" alt="Il _logarithmic binning_ incrementale consente di ridurre il rumore sulla parte destra della distribuzione e, essendo una sequenza esponenziale, presenterà degli intervalli equispaziati sull'asse delle ascisse, espresso su scala logaritmica." /></p>

<p>Il grafico di destra, su scala logaritmica, è ancora una volta quello più interessante. Grazie al logarithmic binning, infatti, abbiamo linearizzato efficacemente anche la parte destra della distribuzione e ora è possibile applicare una regressione per stimare \( \alpha \). Tuttavia, noterete come i punti caratterizzanti ora siano molti di meno.</p>

<p>In effetti, per eliminare il rumore si è reso necessario creare degli intervalli molto ampi e questo ha comportato una notevole perdita di informazioni. Per spiegare meglio il concetto: una volta aggregate le misurazioni all’interno di un bin, le abbiamo perse come entità distinte. E tanto più ampi sono gli intervalli, tante più sono le osservazioni che abbiamo aggregato insieme, e sulle quali non è più possibile affermare nulla singolarmente.</p>

<p>In particolare, è sufficiente che \( \alpha &gt; 1 \), cosa che avviene <em>sempre</em>, per far sì che un intervallo abbia meno campioni dell’intervallo immediatamente alla sua sinistra.</p>

<p>Fortunatamente esiste un modo ancora migliore per rappresentare (e studiare) una power law e consiste nel rappresentarla mediante la <strong>distribuzione di probabilità cumulativa</strong> (cumulative distribution function, o <strong>CDF</strong>).</p>

<p>Se indichiamo con \( P(x) \) la probabilità che \( x \) abbia un valore non più semplicemente uguale ma <strong>maggiore o uguale</strong> a \( x \)</p>

\[P(x) = \int_x^\infty p(x^\prime)dx^\prime\]

<p>Poiché la \( p(x) \) è una power law di tipo</p>

\[p(x) = Cx^{-\alpha}\]

<p>possiamo scrivere</p>

\[P(x) = C\int_x^\infty x^{\prime-\alpha}dx^\prime = \bbox[5px,border:1px solid red]{ \frac{C}{\alpha - 1}x^{-(\alpha - 1 )}} \tag{CDF}\]

<p>La CDF \( P(x) \) di una power law (nel box rosso) è a sua volta, come si può vedere, una power law ma con esponente \( \alpha - 1 \); questo significa che una volta rappresentata su scala log-log presenterà ancora un andamento rettilineo, ma con una pendenza diversa.
Soprattutto,  essa è stata ottenuta <em>senza</em> un binning, quindi senza perdita di informazioni e senza aver dovuto formulare alcuna ipotesi sull’ampiezza degli intervalli (ovvero, fare una scelta empirica). Ancora una volta, usiamo il dataset di Moby Dick per visualizzare la CDF:</p>

<p><img src="/assets/figures/mobydick.cdf-1.svg" alt="plot of chunk mobydick.cdf" /></p>

<p>La CDF del campione è, come si può vedere, molto “pulita” e segue con notevole precisione l’andamento di una power law avente \(\alpha = 1.93\) (retta in rosso).</p>

<h2 id="determinare-i-parametri-della-power-law">Determinare i parametri della power law</h2>

<p>Per quanto molto comune in natura, sono poche le grandezze che presentano un andamento che segue la legge di potenza nell’interezza dei valori della loro CDF; più spesso, si riscontrano distribuzioni che assimilano la legge di potenza sulla parte <em>destra</em> del loro dominio (come nell’esempio sopra), mentre la parte sinistra segue un andamento diverso.</p>

<p>Per questo motivo, è prassi abbastanza comune individuare il valore \( x_{min} \) al di sopra del quale la distribuzione, si verifica, segue in modo soddisfacente la legge di potenza, mentre per i valori al di sotto è opportuno individuare un modello che esprima con minore incertezza l’andamento della CDF, perché la <em>power law</em> non modella adeguatamente la distribuzione; spesso, per questi valori bassi, migliori risultati si hanno con modelli di tipo esponenziale, log-normali o di Poisson. Nell’esempio di Moby Dick, per dire, ha senso applicare il modello <em>power law</em> di cui sopra solo per \(x_{min} \ge 26\)</p>

<p>La stima di \( x_{min} \) può essere fatta in modo visivo, dal grafico della CDF, oppure analiticamente, in modo da avere una stima statisticamente robusta e che, soprattutto, non richieda l’intervento diretto dell’osservatore per l’interpretazione.</p>

<p>L’idea alla base è piuttosto semplice: scegliamo un valore \( \hat{x} \) tale che renda le distribuzioni di probabilità e la migliore <em>power law</em> applicabile (con un dato \( \alpha \)) il più simile possibile per valori sopra \( \hat{x} \). Se il valore di \( \hat x_{min} \) è superiore del valore vero di \( x_{min} \), questo implica scartare un maggior numero di osservazioni (sotto \( x_{min} \)) e, quindi, ottenere, una distribuzione di probabilità più scadente, per via delle fluttuazioni statistiche. D’altra parte, se il valore di \( \hat{x} \) è inferiore al valore vero di \( x_{min} \), le distribuzioni di probabilità divergeranno per la sostanziale differenza tra i dati e il modello stesso. Il valore migliore di \( x_{min} \) giace all’interno di questo intervallo.</p>

<p>La migliore misura per quantificare la distanza tra due distribuzioni di probabilità, per dati che palesemente non seguono la distribuzione nornale, è la statistica KS (o Kolmogorof-Smirnov), ovvero la massima distanza tra le CDF dei dati e il modello:</p>

\[D = \max_{x \ge x_{min}} \left\lvert S(x) - P(x) \right\rvert\]

<p>con \( S(x) \) che rappresenta la CDF delle osservazioni per valori che siano almeno \( x_{min} \) e \( P(x) \) la CDF del modello <em>power law</em> che rappresenta la miglior stima possibile. La stima \( \hat{x} \) di \( x_{min} \) è quella che minimizza \( D \).</p>

<p>Una volta individuato un soddisfacente \( x_{min} \), è possibile stimare un adeguato \( \alpha \). Per farlo, l’approccio migliore è utilizzare il <a href="https://it.wikipedia.org/wiki/Metodo_della_massima_verosimiglianza">metodo della massima verosmiglianza</a> (MLE), posto che vi sia un adeguato numero di osservazioni con \( x \ge x_{min} \). LA MLE per il caso continuo è la seguente (quella per il caso discreto è molto più complessa e non verrà trattata in questa sede):</p>

\[\hat{\alpha} = 1 + n\left[\sum_{i=1}^n \ln\frac{x_i}{x_{min}}\right] \tag{MLE}\]

<p>Dove \( \hat{\alpha} \) è il valore stimato per \( \alpha \), normalmente non noto, individuato da una popolazione di \( n \) osservazioni \( x_i \) con \( i = 1, 2, \dots, n \), tutti tale che \( x_i \ge x_{min} \).</p>

<p>Naturalmente, la robustezza di tali stimatori va anche essa valutata con un opportuno test per l’ipotesi, ma per essa vi chiedo di attendere il secondo articolo sull’argomento che ho in lavorazione, che riporterà degli esempi pratici in R e che toccherà anche questi temi ulteriori.</p>

<h2 id="esempi-noti-in-letteratura">Esempi noti in letteratura</h2>

<p>Dai ricercatori, sono stati spesso studiati e citati dei campioni che esprimono un andamento della CDF come legge di potenza. Vediamo i più famosi:</p>

<ul>
  <li>
    <p><strong>Frequenza delle parole nei testi</strong> - lo abbiamo visto con Moby Dick, ma il linguista <a href="https://en.wikipedia.org/wiki/George_Kingsley_Zipf">George Kingsley Zipf</a> ha potuto verificare come questo accada in tutta la letteratura occidentale. La trattazione è riportata in <a href="https://www.amazon.it/Human-Behavior-Principle-Least-Effort/dp/161427312X">un suo elegante lavoro</a> del 1949.</p>
  </li>
  <li>
    <p><strong>Citazioni nelle pubblicazioni scientifiche</strong> - dimostrata da Derek J. de Solla Price in un <a href="http://garfield.library.upenn.edu/papers/pricenetworks1965.pdf">articolo su Science</a> nel lontano 1965.</p>
  </li>
</ul>

<h2 id="un-esempio-tutto-nostro-i-comuni-italiani">Un esempio tutto nostro: i comuni italiani</h2>

<p>Per completare la trattazione, volevo brevemente studiare un campione che molto spesso, in letteratura, è stato assimilato ad una <em>power law</em>: la popolazione degli insediamenti umani in una data nazione.</p>

<p>Così, per essere originale, ho ben pensato di studiare il dataset dei communi italiani, messo a disposizione dall’ISTAT a valle dell’ultimo censimento nazionale. Si tratta di un dataset di 7978 comuni italiani con una popolazione compresa tra 30 e 2873494 abitanti.</p>

<p>Il valore del più piccolo comune d’Italia,  (30, si tratta del comune di Moncenisio, in provincia di Torino) mi ha fatto subito sospettare che la parte sinistra della distribuzione avesse un comportamento singolare (difficile pensare che ci siano più comuni di 30 abitanti rispetto agli altri).</p>

<p>Prima, però, di stimare un \( x_{min} \) per la CDF, mi sono chiesto se la distribuzione, una volta applicato il binning logaritmico, non potesse assumere una forma canonica. Così, dopo aver segmentato la popolazione in 100 intervalli ho ottenuto questo plot della densità e della percentuale di osservazioni.</p>

<p><img src="/assets/figures/italian.towns.plots-1.svg" alt="plot of chunk italian.towns.plots" /></p>

<p>Ebbene, questo grafico mi ha subito dato la sensazione di un andamento che segue una <a href="https://it.wikipedia.org/wiki/Distribuzione_lognormale">distribuzione log-normale</a>, con una leggera distonia sulla “coda” destra che può essere imputabile a un andamento secondo la legge di potenza.</p>

<p>Il prossimo passo è stato, perciò, quello di individuare, attraverso il metodo di massima verosimiglianza spiegato sopra, due modelli, uno di tipo <em>power law</em> e uno di tipo log-normale. L’ho fatto, naturalmente, sulla CDF e ho ottenuto il seguente:</p>

<p><img src="/assets/figures/italian.towns.cdf-1.svg" alt="plot of chunk italian.towns.cdf" /></p>

<p>Ebbene, come previsto il modello log-normale (in verde) riesce a descrivere il campione per gran parte del suo codominio (ha \( x_{min_1} = 430\), fino a \( x_{min_2} = 99469\), al di sopra del quale è la legge di potenza (in rosso) caratterizzata dal parametro \( \alpha = 2.41 \) a descrivere meglio la curva di distribuzione della CDF.</p>

<p>Poiché, per ciò che avevamo ipotizzato sui dati, lo studio della funzione non è interessante per valori inferiori di \( x_{min_1} \), il <em>fitting</em> si può arrestare qui. Ciò che bisognerebbe fare per terminare il lavoro è, come dicevamo, un opportuno test per verificare la robustezza degli stimatori, ma oggettivamente, nel caso specifico l’ispezione visiva dei grafici fornisce già, con discreto margine di sicurezza, le garanzie necessarie.</p>

<h2 id="per-approfondire">Per approfondire</h2>

<ul>
  <li>M. E. J. Newman, <a href="https://arxiv.org/pdf/cond-mat/0412004.pdf">Power laws, Pareto distributions and Zipf’s law</a>, 2006;</li>
  <li>Aaron Clauset, Cosma Rohilla Shalizi, M. E. J. Newman, <a href="https://arxiv.org/pdf/0706.1062.pdf">Power Laws Distributions in Empirical Data</a>, 2009</li>
</ul>

        
      </section>

      <footer class="page__meta">
        
        


  


  
  
  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categorie: </strong>
    <span itemprop="keywords">
    
      
      
      <a href="/categorie/#matematica" class="page__taxonomy-item" rel="tag">Matematica</a>
    
    </span>
  </p>


        
    <p class="page__date"><strong><i class="fa fa-fw fa-calendar" aria-hidden="true"></i> Aggiornato:</strong> <time datetime="2018-08-12T00:00:00-05:00">August 12, 2018</time></p>

      </footer>

      <section class="page__share">
  
    <h4 class="page__share-title">Condividi</h4>
  

  <div class="addthis_inline_share_toolbox"></div>

</section>


      
  <nav class="pagination">
    
      <a href="/legge-potenza-powerlaw/" class="pagination--pager" title="Approfondimento matematico: la power law
">Precedente</a>
    
    
      <a href="/reti-smallworld/" class="pagination--pager" title="Le caratteristiche di un mondo sorprendentemente piccolo
">Prossima</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">Potrebbe piacerti anche</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/lagrange-teaser.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/teorema-energia-cinetica/" rel="permalink">Il teorema dell’energia cinetica
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minuti di lettura
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">La meccanica quantistica non è strana al punto da mettere del tutto in discussione il principio di conservazione dell’energia. Ma cosa possiamo dire, esattam...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/focault-pendulum-teaser.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/spazio-degli-stati/" rel="permalink">Lo spazio degli stati
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          8 minuti di lettura
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Senza un minimo di concetti base di Meccanica Razionale non si va molto oltre, nello studio della fisica. La materia è certamente ostica, ma come di consueto...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/focault-pendulum-teaser.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/spazio-degli-stati/" rel="permalink">Lo spazio degli stati
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minuti di lettura
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Senza un minimo di concetti base di Meccanica Razionale non si va molto oltre, nello studio della fisica. La materia è certamente ostica, ma come di consueto...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="/assets/images/stati-spin-teaser.jpg" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/stati-spin/" rel="permalink">Stati di Spin
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          10 minuti di lettura
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">È giunto il momento di verificare se il modello matematico che abbiamo derivato per descrivere gli stati quantistici funziona. Mettiamolo alla prova con il s...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Ricerca
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Inserisci termini di ricerca..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <!-- start custom footer snippets -->

<!-- end custom footer snippets -->
        <div class="page__footer-follow">

</div>

<div class="page__footer-copyright">&copy; 2020 Gabriele Baldassarre  - <a href="/sitemap">Mappa del Sito</a></div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-WH4NHF"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'GTM-WH4NHF', { 'anonymize_ip': false});
</script>







  
    <script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5d790b1b248d9eaf"></script>
  



  </body>
</html>
