---
title: "Perché viviamo in un mondo piccolo?"
excerpt: Lorem ipsum dolor sic amet
header:
  overlay_filter: 0.5
  overlay_image: /assets/images/small-world-overlay.jpg
editor_options:
  chunk_output_type: inline
---
```{r smallworld.setup, include = FALSE, cache = FALSE}
if (!require("pacman")) install.packages("pacman"); invisible(library(pacman))
tryCatch({
  p_load("tidyverse", "igraph")
}, warning=function(w){
  stop(conditionMessage(w))
})

old.par <- par()

par(mar=c(4, 4, 2, 1),
    mgp=c(3, 0.4, 0),
    tck=-.01,
    oma=c(0,1,2,0),
    cex.axis=0.9,
    las=1)

#Set here parameters for consistency
vertex.color <- "darkblue"
vertex.size = 9

```
Se esiste un concetto della Social Network Analysis che è noto al grande pubblico è quello dei [sei gradi di separazione](https://it.wikipedia.org/wiki/Sei_gradi_di_separazione), per quanto questa sia principalmente l'interpretazione letteraria di una [teoria](https://it.wikipedia.org/wiki/Teoria_del_mondo_piccolo) a sua volta frutto di un esperimento empirico molto contestato (l'[esperimento di Milgram](https://en.wikipedia.org/wiki/Small-world_experiment) del 1967).

In natura, si sa, le coincidenze, se esistono, si danno la pena di non farsi trovare e il fatto che, andando a ben scavare, ci accorgiamo di essere distanti solo tre passaggi da Francesco Guccini e cinque da Isaac Newton potrebbe essere frutto del caso oppure della propensione innata della natura (e degli individui) di creare connessioni con i propri simili in punti imprevedibili della rete.

Quale che sia la causa non è importante, mentre lo sono gli effetti: il mondo è sorprendentemente piccolo.

### Gruppi e sottogruppi in una rete sociale

Più precisamente, viviamo in un mondo in cui due individui qualunque sono separati, in media, da non più di una mezza dozzina di intermediari; e non importa se il primo sia in Spagna e il secondo sull'Isola di Pasqua.

Strano, vero? Eppure questo fenomeno non dovrebbe sorprendere, perché è, almeno numericamente, plausibile.

L'antropologia sociale ci insegna che un individuo è in grado di intrattenere relazioni socialmente attive con un numero di consimili che varia da 250 a 500, grazie anche all'avvento dei Social Network. Facendo due conti ed essendo anche al massimo conservativi questi sono i numeri della mia rete sociale:

* \\( 250^1 = 250 \\) individui a un passo di distanza da me;
* \\( 250^2 = `r format(250^2, scientific = FALSE, big.mark=".") ` \\) individui a due passi di distanza da me;
* \\( 250^3 = `r format(250^3, scientific = FALSE, big.mark=".") ` \\) individui a tre passi di distanza da me.
* ...

È facile osservare come non ci sia nemmeno bisogno di arrivare a sei per includere l'intera umanità nella cerchia. Nonostante i due individui siano separati da migliaia di chilometri di oceani, deserti e montagne, la matematica non lascia adito a dubbi: sono _vicini_.

Eppure il numero magico è 6, non 3, ma nemmeno 12, 50 o 120, come si aspettava, intuitivamente e senza aver fatto troppi conti, Milgram durante il suo famoso esperimento.

Il punto è che, nelle loro relazioni, gli individui non scelgono le proprie connessioni in modo casuale, ma mantengono una certa coerenza _locale_.

In altri termini, la progressione matematica parte dal presupposto che ognuna delle, ipotizziamo, 250 connessioni di ognuno dei miei amici siano 250 individui distinti. Se ognuno di essi scegliesse, per i suoi 250 amici, degli individui completamente a caso potendoli pescare dall'intero genere umano, questa assunzione reggerebbe.

Ma gli esseri umani non hanno tutte queste libertà, perché sono soggetti a tanti vincoli,  sociali, geografici, di età di razza, ecc. che riducono di moltissimo le possibilità di scelta nella creazione della loro rete sociale. Che non sarà più casuale, ma imposta in modo tale da facilitare la creazione di sottogruppi _per prossimità_.

Nel mondo reale, in effetti, i nostri amici si conoscono, molto probabilmente, anche tra di loro; un individuo che è parte della nostra cerchia non porterà 250 nuovi individui all'interno del gruppo, ma molti di meno, in quanto gran parte di quei 250 sono già componenti del gruppo stesso.

Attenzione: una parte, non tutti.

Se così non fosse, se cioè nessuno dei nostri amici avesse delle connessioni con individui all'esterno della cerchia, o ne avesse in numero trascurabile, ci ritroveremmo con una serie di "isole" fittissime del tutto sconnesse le une dalle altre, o connesse in modo così sporadico dal rendere irrealistico il numero magico dei sei gradi di separazione.

Empiricamente, se gli individui che compongono una rete sociale:

* hanno la maggior parte delle proprie connessioni con membri che sono a loro volta connessi tra di loro, individuando un sottogruppo ricco di connessioni reciproche;

e, contemporaneamente

* hanno anche un non trascurabile numero di connessioni con individui all'esterno della propria cerchia, in punti anche molto lontani che fungono da "scorciatoie" in grado di abbattono le distanze medie tra tutti gli individui della rete

ebbene, ci troviamo di fronte a un mondo piccolo, ovvero a una __rete small-world__.

Per riprendere l'esempio di prima, basta un'amicizia nata per caso, invento, durante un viaggio di piacere di un turista spagnolo in Cile per abbattere le distanze che separano non solo i due diretti interessati, ma anche tutti i componenti delle rispettive cerchie, e a loro volta i loro vicini e così via.

Nel concreto, il mondo è piccolo non perché tutti sono a contatto con tutti, ma perché ci sono diverse occasioni di connessione tra individui collocati in punti _molto distanti_ della rete.

Duncan Watts e Steven Strogatz si sobbarcarono l'arduo compito di trasformare tutto ciò in scienza o, per essere più precisi, in un modello.

### Il modello Watts-Strogatz: l'intuizione

Per costruire un solido modello scientifico è necessario un solo ingrediente: l'ordine.

Le reti sociali non sono esattamente oggetti ordinati (non a caso vi si fa riferimento come _complex network_) e non deve essere sembrato saggio a Duncan Watts e Steven Strogatz di tuffarsi in tutta quella confusione. Molto meglio partire con qualcosa che potevano controllare meglio e questo qualcosa sono le __reti regolari__ ovvero quelle reti, simulabili in un laboratorio, in cui gli \\( N \\) nodi si dispongonono in un anello e ognuno di questi ha \\( k \\) connessioni tra i nodi vicini.


In termini probabilistici, una possibile definizione di una rete small-world potrebbe essere quella di una rete in cui la maggior parte dei nodi __non__ sono connessi tra di loro, ma le connessioni di un nodo qualsiasi della rete hanno elevata probabilità di essere anche connessi tra di loro e tutti i nodi siano, da qualunque punto, raggiungibile con un relativamente ridotto numero di passaggi.

```{r watts-strogatz-randomness, warning = FALSE, fig.asp = .4}

par(mfrow=c(1,3))

ring.network <- sample_smallworld(1, 20, 2, 0)

l <- layout_in_circle(ring.network)

smallworld.network <- sample_smallworld(1, 20, 2, 0.1)
random.network <- sample_smallworld(1, 20, 2, 1)

plot(ring.network,
     vertex.size = vertex.size,
     vertex.color = vertex.color,
     vertex.label = NA)
mtext("p = 0", side = 1, line = 0, cex = 1.5)
title(main="Rete Regolare", cex.main = 1.5)

plot(smallworld.network,
     vertex.size = vertex.size,
     vertex.color = vertex.color,
     vertex.label = NA,
     layout = l)
mtext("p = 0.1", side = 1, line = 0, cex = 1.5)
title(main="Rete Small-World", cex.main = 1.5)

plot(random.network,
     vertex.size = vertex.size,
     vertex.color = vertex.color,
     vertex.label = NA,
     layout = l)
mtext("p = 1", side = 1, line = 0, cex = 1.5)
title(main="Rete Casuale", cex.main = 1.5)

```

```{r watts-strogatz.stats, warning = FALSE, fig.asp = .6}

par(mfrow=c(1,1))

set.seed(12)
avg.stat <- function(nei, p) {
  result <- replicate(1000, {
    wsg <- watts.strogatz.game(1, 100, nei, p)
    c(average.path.length(wsg),
      transitivity(wsg))
  })
  apply(result, 1, quantile, probs = c(0.5, 0.05, 0.95))
}
nei <- 6
p <- 2 ^ -seq(0, 10, len = 21)
result <- sapply(p, avg.stat, nei = nei)
result <- t(result / rep(avg.stat(nei, 0)[1,], each = 3))
par(mar=c(3.2, 2, 0.2, 0.2), mgp=c(2, 1, 0))
matplot(p, result, type = "l", log = "x", xaxt = "n", ylab = "",
        lty = rep(c(1,2,2),2), col=rep(c(1,2), each=3))
axis(1, at = 2 ^ -(0:10),
     labels =  c(1, parse(text = paste(2, 1:10, sep = "^-",
                                       collapse = ";"))))
legend("bottomleft", c("Lunghezza media percorsi", "Coefficiente di clustering"),
       lty = 1, col = c(1, 2))

```
